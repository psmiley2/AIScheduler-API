function cov_20wkxw7cx5(){var path="C:\\Users\\peter\\Desktop\\Files\\perhail\\server\\routes\\preferences.js";var hash="bb3b65409232f6894d9422f10ca95adcfc276562";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\peter\\Desktop\\Files\\perhail\\server\\routes\\preferences.js",statementMap:{"0":{start:{line:1,column:16},end:{line:1,column:34}},"1":{start:{line:2,column:15},end:{line:2,column:31}},"2":{start:{line:3,column:21},end:{line:3,column:39}},"3":{start:{line:5,column:13},end:{line:5,column:38}},"4":{start:{line:9,column:0},end:{line:45,column:3}},"5":{start:{line:10,column:17},end:{line:10,column:34}},"6":{start:{line:11,column:17},end:{line:11,column:19}},"7":{start:{line:12,column:4},end:{line:14,column:5}},"8":{start:{line:13,column:8},end:{line:13,column:69}},"9":{start:{line:16,column:4},end:{line:19,column:5}},"10":{start:{line:17,column:8},end:{line:17,column:37}},"11":{start:{line:18,column:8},end:{line:18,column:15}},"12":{start:{line:21,column:24},end:{line:24,column:5}},"13":{start:{line:26,column:4},end:{line:36,column:44}},"14":{start:{line:30,column:12},end:{line:34,column:13}},"15":{start:{line:31,column:16},end:{line:33,column:18}},"16":{start:{line:36,column:24},end:{line:36,column:42}},"17":{start:{line:38,column:4},end:{line:41,column:5}},"18":{start:{line:39,column:8},end:{line:39,column:37}},"19":{start:{line:40,column:8},end:{line:40,column:15}},"20":{start:{line:44,column:4},end:{line:44,column:40}},"21":{start:{line:50,column:0},end:{line:80,column:3}},"22":{start:{line:51,column:17},end:{line:51,column:34}},"23":{start:{line:52,column:22},end:{line:52,column:24}},"24":{start:{line:53,column:17},end:{line:53,column:19}},"25":{start:{line:55,column:4},end:{line:57,column:5}},"26":{start:{line:56,column:8},end:{line:56,column:69}},"27":{start:{line:59,column:4},end:{line:62,column:5}},"28":{start:{line:60,column:8},end:{line:60,column:37}},"29":{start:{line:61,column:8},end:{line:61,column:15}},"30":{start:{line:64,column:4},end:{line:72,column:7}},"31":{start:{line:65,column:8},end:{line:71,column:9}},"32":{start:{line:66,column:12},end:{line:66,column:43}},"33":{start:{line:68,column:12},end:{line:70,column:14}},"34":{start:{line:74,column:4},end:{line:77,column:5}},"35":{start:{line:75,column:8},end:{line:75,column:37}},"36":{start:{line:76,column:8},end:{line:76,column:15}},"37":{start:{line:79,column:4},end:{line:79,column:38}},"38":{start:{line:85,column:0},end:{line:130,column:3}},"39":{start:{line:86,column:35},end:{line:86,column:45}},"40":{start:{line:87,column:17},end:{line:87,column:19}},"41":{start:{line:88,column:21},end:{line:88,column:25}},"42":{start:{line:90,column:4},end:{line:92,column:5}},"43":{start:{line:91,column:8},end:{line:91,column:69}},"44":{start:{line:94,column:4},end:{line:96,column:5}},"45":{start:{line:95,column:8},end:{line:95,column:75}},"46":{start:{line:98,column:4},end:{line:101,column:5}},"47":{start:{line:99,column:8},end:{line:99,column:37}},"48":{start:{line:100,column:8},end:{line:100,column:15}},"49":{start:{line:103,column:4},end:{line:123,column:7}},"50":{start:{line:104,column:8},end:{line:122,column:9}},"51":{start:{line:106,column:12},end:{line:112,column:13}},"52":{start:{line:107,column:16},end:{line:111,column:17}},"53":{start:{line:109,column:20},end:{line:109,column:35}},"54":{start:{line:110,column:20},end:{line:110,column:26}},"55":{start:{line:113,column:12},end:{line:117,column:13}},"56":{start:{line:114,column:16},end:{line:116,column:18}},"57":{start:{line:119,column:12},end:{line:121,column:14}},"58":{start:{line:125,column:4},end:{line:129,column:5}},"59":{start:{line:126,column:8},end:{line:126,column:37}},"60":{start:{line:128,column:8},end:{line:128,column:41}},"61":{start:{line:134,column:16},end:{line:140,column:1}},"62":{start:{line:135,column:4},end:{line:137,column:5}},"63":{start:{line:136,column:8},end:{line:136,column:21}},"64":{start:{line:138,column:4},end:{line:138,column:16}},"65":{start:{line:142,column:0},end:{line:142,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:24},end:{line:9,column:25}},loc:{start:{line:9,column:44},end:{line:45,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:29,column:14},end:{line:29,column:15}},loc:{start:{line:29,column:23},end:{line:35,column:9}},line:29},"2":{name:"(anonymous_2)",decl:{start:{line:36,column:15},end:{line:36,column:16}},loc:{start:{line:36,column:24},end:{line:36,column:42}},line:36},"3":{name:"(anonymous_3)",decl:{start:{line:50,column:23},end:{line:50,column:24}},loc:{start:{line:50,column:43},end:{line:80,column:1}},line:50},"4":{name:"(anonymous_4)",decl:{start:{line:64,column:37},end:{line:64,column:38}},loc:{start:{line:64,column:47},end:{line:72,column:5}},line:64},"5":{name:"(anonymous_5)",decl:{start:{line:85,column:37},end:{line:85,column:38}},loc:{start:{line:85,column:57},end:{line:130,column:1}},line:85},"6":{name:"(anonymous_6)",decl:{start:{line:103,column:37},end:{line:103,column:38}},loc:{start:{line:103,column:47},end:{line:123,column:5}},line:103},"7":{name:"(anonymous_7)",decl:{start:{line:134,column:16},end:{line:134,column:17}},loc:{start:{line:134,column:24},end:{line:140,column:1}},line:134}},branchMap:{"0":{loc:{start:{line:12,column:4},end:{line:14,column:5}},type:"if",locations:[{start:{line:12,column:4},end:{line:14,column:5}},{start:{line:12,column:4},end:{line:14,column:5}}],line:12},"1":{loc:{start:{line:12,column:8},end:{line:12,column:50}},type:"binary-expr",locations:[{start:{line:12,column:8},end:{line:12,column:27}},{start:{line:12,column:31},end:{line:12,column:50}}],line:12},"2":{loc:{start:{line:16,column:4},end:{line:19,column:5}},type:"if",locations:[{start:{line:16,column:4},end:{line:19,column:5}},{start:{line:16,column:4},end:{line:19,column:5}}],line:16},"3":{loc:{start:{line:30,column:12},end:{line:34,column:13}},type:"if",locations:[{start:{line:30,column:12},end:{line:34,column:13}},{start:{line:30,column:12},end:{line:34,column:13}}],line:30},"4":{loc:{start:{line:38,column:4},end:{line:41,column:5}},type:"if",locations:[{start:{line:38,column:4},end:{line:41,column:5}},{start:{line:38,column:4},end:{line:41,column:5}}],line:38},"5":{loc:{start:{line:55,column:4},end:{line:57,column:5}},type:"if",locations:[{start:{line:55,column:4},end:{line:57,column:5}},{start:{line:55,column:4},end:{line:57,column:5}}],line:55},"6":{loc:{start:{line:55,column:8},end:{line:55,column:50}},type:"binary-expr",locations:[{start:{line:55,column:8},end:{line:55,column:27}},{start:{line:55,column:31},end:{line:55,column:50}}],line:55},"7":{loc:{start:{line:59,column:4},end:{line:62,column:5}},type:"if",locations:[{start:{line:59,column:4},end:{line:62,column:5}},{start:{line:59,column:4},end:{line:62,column:5}}],line:59},"8":{loc:{start:{line:65,column:8},end:{line:71,column:9}},type:"if",locations:[{start:{line:65,column:8},end:{line:71,column:9}},{start:{line:65,column:8},end:{line:71,column:9}}],line:65},"9":{loc:{start:{line:74,column:4},end:{line:77,column:5}},type:"if",locations:[{start:{line:74,column:4},end:{line:77,column:5}},{start:{line:74,column:4},end:{line:77,column:5}}],line:74},"10":{loc:{start:{line:90,column:4},end:{line:92,column:5}},type:"if",locations:[{start:{line:90,column:4},end:{line:92,column:5}},{start:{line:90,column:4},end:{line:92,column:5}}],line:90},"11":{loc:{start:{line:90,column:8},end:{line:90,column:50}},type:"binary-expr",locations:[{start:{line:90,column:8},end:{line:90,column:27}},{start:{line:90,column:31},end:{line:90,column:50}}],line:90},"12":{loc:{start:{line:94,column:4},end:{line:96,column:5}},type:"if",locations:[{start:{line:94,column:4},end:{line:96,column:5}},{start:{line:94,column:4},end:{line:96,column:5}}],line:94},"13":{loc:{start:{line:94,column:8},end:{line:94,column:62}},type:"binary-expr",locations:[{start:{line:94,column:8},end:{line:94,column:33}},{start:{line:94,column:37},end:{line:94,column:62}}],line:94},"14":{loc:{start:{line:98,column:4},end:{line:101,column:5}},type:"if",locations:[{start:{line:98,column:4},end:{line:101,column:5}},{start:{line:98,column:4},end:{line:101,column:5}}],line:98},"15":{loc:{start:{line:104,column:8},end:{line:122,column:9}},type:"if",locations:[{start:{line:104,column:8},end:{line:122,column:9}},{start:{line:104,column:8},end:{line:122,column:9}}],line:104},"16":{loc:{start:{line:107,column:16},end:{line:111,column:17}},type:"if",locations:[{start:{line:107,column:16},end:{line:111,column:17}},{start:{line:107,column:16},end:{line:111,column:17}}],line:107},"17":{loc:{start:{line:113,column:12},end:{line:117,column:13}},type:"if",locations:[{start:{line:113,column:12},end:{line:117,column:13}},{start:{line:113,column:12},end:{line:117,column:13}}],line:113},"18":{loc:{start:{line:125,column:4},end:{line:129,column:5}},type:"if",locations:[{start:{line:125,column:4},end:{line:129,column:5}},{start:{line:125,column:4},end:{line:129,column:5}}],line:125},"19":{loc:{start:{line:135,column:4},end:{line:137,column:5}},type:"if",locations:[{start:{line:135,column:4},end:{line:137,column:5}},{start:{line:135,column:4},end:{line:137,column:5}}],line:135},"20":{loc:{start:{line:135,column:8},end:{line:135,column:42}},type:"binary-expr",locations:[{start:{line:135,column:8},end:{line:135,column:23}},{start:{line:135,column:27},end:{line:135,column:42}}],line:135}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"bb3b65409232f6894d9422f10ca95adcfc276562"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_20wkxw7cx5=function(){return actualCoverage;};}return actualCoverage;}cov_20wkxw7cx5();const express=(cov_20wkxw7cx5().s[0]++,require("express"));const router=(cov_20wkxw7cx5().s[1]++,express.Router());const{ObjectID}=(cov_20wkxw7cx5().s[2]++,require("mongodb"));const User=(cov_20wkxw7cx5().s[3]++,require("../models/User"));// SECTION - CREATE PREFERENCE
// Add a new preference
cov_20wkxw7cx5().s[4]++;router.post("/:userid",async(req,res)=>{cov_20wkxw7cx5().f[0]++;let userid=(cov_20wkxw7cx5().s[5]++,req.params.userid);let errors=(cov_20wkxw7cx5().s[6]++,[]);cov_20wkxw7cx5().s[7]++;if((cov_20wkxw7cx5().b[1][0]++,userid==undefined)||(cov_20wkxw7cx5().b[1][1]++,userid.length!=24)){cov_20wkxw7cx5().b[0][0]++;cov_20wkxw7cx5().s[8]++;errors.push("a valid userid must be set as a url parameter");}else{cov_20wkxw7cx5().b[0][1]++;}cov_20wkxw7cx5().s[9]++;if(errors.length>0){cov_20wkxw7cx5().b[2][0]++;cov_20wkxw7cx5().s[10]++;res.status(400).send(errors);cov_20wkxw7cx5().s[11]++;return;}else{cov_20wkxw7cx5().b[2][1]++;}let newPreference=(cov_20wkxw7cx5().s[12]++,{_id:new ObjectID(),title:req.body.title});cov_20wkxw7cx5().s[13]++;await User.findByIdAndUpdate(userid,{$push:{preferences:newPreference}}).then(res=>{cov_20wkxw7cx5().f[1]++;cov_20wkxw7cx5().s[14]++;if(!res){cov_20wkxw7cx5().b[3][0]++;cov_20wkxw7cx5().s[15]++;errors.push("could not find a user in the database with the given user id");}else{cov_20wkxw7cx5().b[3][1]++;}}).catch(err=>{cov_20wkxw7cx5().f[2]++;cov_20wkxw7cx5().s[16]++;return console.error(err);});cov_20wkxw7cx5().s[17]++;if(errors.length>0){cov_20wkxw7cx5().b[4][0]++;cov_20wkxw7cx5().s[18]++;res.status(400).send(errors);cov_20wkxw7cx5().s[19]++;return;}else{cov_20wkxw7cx5().b[4][1]++;}// No errros
cov_20wkxw7cx5().s[20]++;res.status(201).send(newPreference);});// !SECTION
// SECTION - FETCH ALL PREFERENCES
// Fetch all preferences
cov_20wkxw7cx5().s[21]++;router.get("/:userid",async(req,res)=>{cov_20wkxw7cx5().f[3]++;let userid=(cov_20wkxw7cx5().s[22]++,req.params.userid);let preferences=(cov_20wkxw7cx5().s[23]++,[]);let errors=(cov_20wkxw7cx5().s[24]++,[]);cov_20wkxw7cx5().s[25]++;if((cov_20wkxw7cx5().b[6][0]++,userid==undefined)||(cov_20wkxw7cx5().b[6][1]++,userid.length!=24)){cov_20wkxw7cx5().b[5][0]++;cov_20wkxw7cx5().s[26]++;errors.push("a valid userid must be set as a url parameter");}else{cov_20wkxw7cx5().b[5][1]++;}cov_20wkxw7cx5().s[27]++;if(errors.length>0){cov_20wkxw7cx5().b[7][0]++;cov_20wkxw7cx5().s[28]++;res.status(400).send(errors);cov_20wkxw7cx5().s[29]++;return;}else{cov_20wkxw7cx5().b[7][1]++;}cov_20wkxw7cx5().s[30]++;await User.findById(userid).then(user=>{cov_20wkxw7cx5().f[4]++;cov_20wkxw7cx5().s[31]++;if(user){cov_20wkxw7cx5().b[8][0]++;cov_20wkxw7cx5().s[32]++;preferences=user.preferences;}else{cov_20wkxw7cx5().b[8][1]++;cov_20wkxw7cx5().s[33]++;errors.push("could not find a user in the database with the given user id");}});cov_20wkxw7cx5().s[34]++;if(errors.length>0){cov_20wkxw7cx5().b[9][0]++;cov_20wkxw7cx5().s[35]++;res.status(400).send(errors);cov_20wkxw7cx5().s[36]++;return;}else{cov_20wkxw7cx5().b[9][1]++;}cov_20wkxw7cx5().s[37]++;res.status(200).send(preferences);});// !SECTION
// SECTION - FETCH PREFERENCE
// Fetch a preference
cov_20wkxw7cx5().s[38]++;router.get("/:userid/:preferenceid",async(req,res)=>{cov_20wkxw7cx5().f[5]++;let{userid,preferenceid}=(cov_20wkxw7cx5().s[39]++,req.params);let errors=(cov_20wkxw7cx5().s[40]++,[]);let preference=(cov_20wkxw7cx5().s[41]++,null);cov_20wkxw7cx5().s[42]++;if((cov_20wkxw7cx5().b[11][0]++,userid==undefined)||(cov_20wkxw7cx5().b[11][1]++,userid.length!=24)){cov_20wkxw7cx5().b[10][0]++;cov_20wkxw7cx5().s[43]++;errors.push("a valid userid must be set as a url parameter");}else{cov_20wkxw7cx5().b[10][1]++;}cov_20wkxw7cx5().s[44]++;if((cov_20wkxw7cx5().b[13][0]++,preferenceid==undefined)||(cov_20wkxw7cx5().b[13][1]++,preferenceid.length!=24)){cov_20wkxw7cx5().b[12][0]++;cov_20wkxw7cx5().s[45]++;errors.push("a valid preferenceid must be set as a url parameter");}else{cov_20wkxw7cx5().b[12][1]++;}cov_20wkxw7cx5().s[46]++;if(errors.length>0){cov_20wkxw7cx5().b[14][0]++;cov_20wkxw7cx5().s[47]++;res.status(400).send(errors);cov_20wkxw7cx5().s[48]++;return;}else{cov_20wkxw7cx5().b[14][1]++;}cov_20wkxw7cx5().s[49]++;await User.findById(userid).then(user=>{cov_20wkxw7cx5().f[6]++;cov_20wkxw7cx5().s[50]++;if(user){cov_20wkxw7cx5().b[15][0]++;cov_20wkxw7cx5().s[51]++;// User found
for(p of user.preferences){cov_20wkxw7cx5().s[52]++;if(p._id==preferenceid){cov_20wkxw7cx5().b[16][0]++;cov_20wkxw7cx5().s[53]++;// Preference found
preference=p;cov_20wkxw7cx5().s[54]++;break;}else{cov_20wkxw7cx5().b[16][1]++;}}cov_20wkxw7cx5().s[55]++;if(preference==null){cov_20wkxw7cx5().b[17][0]++;cov_20wkxw7cx5().s[56]++;errors.push("could not find a preference in the database for the given preference id for this user");}else{cov_20wkxw7cx5().b[17][1]++;}}else{cov_20wkxw7cx5().b[15][1]++;cov_20wkxw7cx5().s[57]++;errors.push("could not find a user in the database with the given user id");}});cov_20wkxw7cx5().s[58]++;if(errors.length>0){cov_20wkxw7cx5().b[18][0]++;cov_20wkxw7cx5().s[59]++;res.status(400).send(errors);}else{cov_20wkxw7cx5().b[18][1]++;cov_20wkxw7cx5().s[60]++;res.status(200).send(preference);}});// !SECTION
// TODO - DELETE PREFERENCE
// TODO - UPDATE PREFERENCE
cov_20wkxw7cx5().s[61]++;const validID=id=>{cov_20wkxw7cx5().f[7]++;cov_20wkxw7cx5().s[62]++;if((cov_20wkxw7cx5().b[20][0]++,id==undefined)||(cov_20wkxw7cx5().b[20][1]++,id.length!=24)){cov_20wkxw7cx5().b[19][0]++;cov_20wkxw7cx5().s[63]++;return false;}else{cov_20wkxw7cx5().b[19][1]++;}cov_20wkxw7cx5().s[64]++;return true;// More validation
};cov_20wkxw7cx5().s[65]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByZWZlcmVuY2VzLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwicm91dGVyIiwiUm91dGVyIiwiT2JqZWN0SUQiLCJVc2VyIiwicG9zdCIsInJlcSIsInJlcyIsInVzZXJpZCIsInBhcmFtcyIsImVycm9ycyIsInVuZGVmaW5lZCIsImxlbmd0aCIsInB1c2giLCJzdGF0dXMiLCJzZW5kIiwibmV3UHJlZmVyZW5jZSIsIl9pZCIsInRpdGxlIiwiYm9keSIsImZpbmRCeUlkQW5kVXBkYXRlIiwiJHB1c2giLCJwcmVmZXJlbmNlcyIsInRoZW4iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImdldCIsImZpbmRCeUlkIiwidXNlciIsInByZWZlcmVuY2VpZCIsInByZWZlcmVuY2UiLCJwIiwidmFsaWRJRCIsImlkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6InVwVUFlWTsyRkFmWixLQUFNQSxDQUFBQSxPQUFPLDBCQUFHQyxPQUFPLENBQUMsU0FBRCxDQUFWLENBQWIsQ0FDQSxLQUFNQyxDQUFBQSxNQUFNLDBCQUFHRixPQUFPLENBQUNHLE1BQVIsRUFBSCxDQUFaLENBQ0EsS0FBTSxDQUFFQyxRQUFGLDJCQUFlSCxPQUFPLENBQUMsU0FBRCxDQUF0QixDQUFOLENBRUEsS0FBTUksQ0FBQUEsSUFBSSwwQkFBR0osT0FBTyxDQUFDLGdCQUFELENBQVYsQ0FBVixDQUVBO0FBQ0E7d0JBQ0FDLE1BQU0sQ0FBQ0ksSUFBUCxDQUFZLFVBQVosQ0FBd0IsTUFBT0MsR0FBUCxDQUFZQyxHQUFaLEdBQW9CLHlCQUN4QyxHQUFJQyxDQUFBQSxNQUFNLDBCQUFHRixHQUFHLENBQUNHLE1BQUosQ0FBV0QsTUFBZCxDQUFWLENBQ0EsR0FBSUUsQ0FBQUEsTUFBTSwwQkFBRyxFQUFILENBQVYsQ0FGd0Msd0JBR3hDLEdBQUksNEJBQUFGLE1BQU0sRUFBSUcsU0FBViwrQkFBdUJILE1BQU0sQ0FBQ0ksTUFBUCxFQUFpQixFQUF4QyxD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VSxFQUFJLElBQWxCLENBQXdCLHNEQUNwQnRCLE1BQU0sQ0FBQ0csSUFBUCxDQUNJLHVGQURKLEVBR0gsQ0FKRCxrQ0FLSCxDQWRELElBY08sc0RBQ0hILE1BQU0sQ0FBQ0csSUFBUCxDQUNJLDhEQURKLEVBR0gsQ0FDSixDQXBCSyxDQUFOLENBbEJxRCx5QkF3Q3JELEdBQUlILE1BQU0sQ0FBQ0UsTUFBUCxDQUFnQixDQUFwQixDQUF1QixzREFDbkJMLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCTCxNQUFyQixFQUNILENBRkQsSUFFTyxzREFDSEgsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJpQixVQUFyQixFQUNILENBQ0osQ0E3Q0QsRUE4Q0E7QUFDQTtBQUNBO3lCQUNBLEtBQU1FLENBQUFBLE9BQU8sQ0FBSUMsRUFBRCxFQUFRLGtEQUNwQixHQUFJLDZCQUFBQSxFQUFFLEVBQUl4QixTQUFOLGdDQUFtQndCLEVBQUUsQ0FBQ3ZCLE1BQUgsRUFBYSxFQUFoQyxDQUFKLENBQXdDLHNEQUNwQyxNQUFPLE1BQVAsQ0FDSCxDQUZELGtDQURvQix5QkFJcEIsTUFBTyxLQUFQLENBQ0E7QUFDSCxDQU5ELEMseUJBUUF3QixNQUFNLENBQUNDLE9BQVAsQ0FBaUJwQyxNQUFqQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKFwiZXhwcmVzc1wiKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgeyBPYmplY3RJRCB9ID0gcmVxdWlyZShcIm1vbmdvZGJcIik7XHJcblxyXG5jb25zdCBVc2VyID0gcmVxdWlyZShcIi4uL21vZGVscy9Vc2VyXCIpO1xyXG5cclxuLy8gU0VDVElPTiAtIENSRUFURSBQUkVGRVJFTkNFXHJcbi8vIEFkZCBhIG5ldyBwcmVmZXJlbmNlXHJcbnJvdXRlci5wb3N0KFwiLzp1c2VyaWRcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBsZXQgdXNlcmlkID0gcmVxLnBhcmFtcy51c2VyaWQ7XHJcbiAgICBsZXQgZXJyb3JzID0gW107XHJcbiAgICBpZiAodXNlcmlkID09IHVuZGVmaW5lZCB8fCB1c2VyaWQubGVuZ3RoICE9IDI0KSB7XHJcbiAgICAgICAgZXJyb3JzLnB1c2goXCJhIHZhbGlkIHVzZXJpZCBtdXN0IGJlIHNldCBhcyBhIHVybCBwYXJhbWV0ZXJcIik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3JzKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IG5ld1ByZWZlcmVuY2UgPSB7XHJcbiAgICAgICAgX2lkOiBuZXcgT2JqZWN0SUQoKSxcclxuICAgICAgICB0aXRsZTogcmVxLmJvZHkudGl0bGUsXHJcbiAgICB9O1xyXG5cclxuICAgIGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUodXNlcmlkLCB7XHJcbiAgICAgICAgJHB1c2g6IHsgcHJlZmVyZW5jZXM6IG5ld1ByZWZlcmVuY2UgfSxcclxuICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXJlcykge1xyXG4gICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjb3VsZCBub3QgZmluZCBhIHVzZXIgaW4gdGhlIGRhdGFiYXNlIHdpdGggdGhlIGdpdmVuIHVzZXIgaWRcIlxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcblxyXG4gICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3JzKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTm8gZXJycm9zXHJcbiAgICByZXMuc3RhdHVzKDIwMSkuc2VuZChuZXdQcmVmZXJlbmNlKTtcclxufSk7XHJcbi8vICFTRUNUSU9OXHJcblxyXG4vLyBTRUNUSU9OIC0gRkVUQ0ggQUxMIFBSRUZFUkVOQ0VTXHJcbi8vIEZldGNoIGFsbCBwcmVmZXJlbmNlc1xyXG5yb3V0ZXIuZ2V0KFwiLzp1c2VyaWRcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBsZXQgdXNlcmlkID0gcmVxLnBhcmFtcy51c2VyaWQ7XHJcbiAgICBsZXQgcHJlZmVyZW5jZXMgPSBbXTtcclxuICAgIGxldCBlcnJvcnMgPSBbXTtcclxuXHJcbiAgICBpZiAodXNlcmlkID09IHVuZGVmaW5lZCB8fCB1c2VyaWQubGVuZ3RoICE9IDI0KSB7XHJcbiAgICAgICAgZXJyb3JzLnB1c2goXCJhIHZhbGlkIHVzZXJpZCBtdXN0IGJlIHNldCBhcyBhIHVybCBwYXJhbWV0ZXJcIik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3JzKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgVXNlci5maW5kQnlJZCh1c2VyaWQpLnRoZW4oKHVzZXIpID0+IHtcclxuICAgICAgICBpZiAodXNlcikge1xyXG4gICAgICAgICAgICBwcmVmZXJlbmNlcyA9IHVzZXIucHJlZmVyZW5jZXM7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZXJyb3JzLnB1c2goXHJcbiAgICAgICAgICAgICAgICBcImNvdWxkIG5vdCBmaW5kIGEgdXNlciBpbiB0aGUgZGF0YWJhc2Ugd2l0aCB0aGUgZ2l2ZW4gdXNlciBpZFwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3JzKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLnNlbmQocHJlZmVyZW5jZXMpO1xyXG59KTtcclxuLy8gIVNFQ1RJT05cclxuXHJcbi8vIFNFQ1RJT04gLSBGRVRDSCBQUkVGRVJFTkNFXHJcbi8vIEZldGNoIGEgcHJlZmVyZW5jZVxyXG5yb3V0ZXIuZ2V0KFwiLzp1c2VyaWQvOnByZWZlcmVuY2VpZFwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIGxldCB7IHVzZXJpZCwgcHJlZmVyZW5jZWlkIH0gPSByZXEucGFyYW1zO1xyXG4gICAgbGV0IGVycm9ycyA9IFtdO1xyXG4gICAgbGV0IHByZWZlcmVuY2UgPSBudWxsO1xyXG5cclxuICAgIGlmICh1c2VyaWQgPT0gdW5kZWZpbmVkIHx8IHVzZXJpZC5sZW5ndGggIT0gMjQpIHtcclxuICAgICAgICBlcnJvcnMucHVzaChcImEgdmFsaWQgdXNlcmlkIG11c3QgYmUgc2V0IGFzIGEgdXJsIHBhcmFtZXRlclwiKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocHJlZmVyZW5jZWlkID09IHVuZGVmaW5lZCB8fCBwcmVmZXJlbmNlaWQubGVuZ3RoICE9IDI0KSB7XHJcbiAgICAgICAgZXJyb3JzLnB1c2goXCJhIHZhbGlkIHByZWZlcmVuY2VpZCBtdXN0IGJlIHNldCBhcyBhIHVybCBwYXJhbWV0ZXJcIik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3JzKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgVXNlci5maW5kQnlJZCh1c2VyaWQpLnRoZW4oKHVzZXIpID0+IHtcclxuICAgICAgICBpZiAodXNlcikge1xyXG4gICAgICAgICAgICAvLyBVc2VyIGZvdW5kXHJcbiAgICAgICAgICAgIGZvciAocCBvZiB1c2VyLnByZWZlcmVuY2VzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocC5faWQgPT0gcHJlZmVyZW5jZWlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUHJlZmVyZW5jZSBmb3VuZFxyXG4gICAgICAgICAgICAgICAgICAgIHByZWZlcmVuY2UgPSBwO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwcmVmZXJlbmNlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY291bGQgbm90IGZpbmQgYSBwcmVmZXJlbmNlIGluIHRoZSBkYXRhYmFzZSBmb3IgdGhlIGdpdmVuIHByZWZlcmVuY2UgaWQgZm9yIHRoaXMgdXNlclwiXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZXJyb3JzLnB1c2goXHJcbiAgICAgICAgICAgICAgICBcImNvdWxkIG5vdCBmaW5kIGEgdXNlciBpbiB0aGUgZGF0YWJhc2Ugd2l0aCB0aGUgZ2l2ZW4gdXNlciBpZFwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3JzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQocHJlZmVyZW5jZSk7XHJcbiAgICB9XHJcbn0pO1xyXG4vLyAhU0VDVElPTlxyXG4vLyBUT0RPIC0gREVMRVRFIFBSRUZFUkVOQ0VcclxuLy8gVE9ETyAtIFVQREFURSBQUkVGRVJFTkNFXHJcbmNvbnN0IHZhbGlkSUQgPSAoaWQpID0+IHtcclxuICAgIGlmIChpZCA9PSB1bmRlZmluZWQgfHwgaWQubGVuZ3RoICE9IDI0KSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgICAvLyBNb3JlIHZhbGlkYXRpb25cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcm91dGVyO1xyXG4iXX0=